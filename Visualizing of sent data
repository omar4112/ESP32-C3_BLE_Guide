import asyncio
from bleak import BleakClient
import matplotlib.pyplot as plt


# Define your ESP32's Bluetooth address
esp32_address = "34:B4:72:EA:77:1E"  # Replace with your ESP32's address


data_x = []
data_y = []


async def run(address):
    async with BleakClient(address) as client:
        x = 0
        while True:
            value = await client.read_gatt_char("beb5483e-36e1-4688-b7f5-ea07361b26a8")
            received = float(value.decode())  # Assuming float values are being sent
            data_y.append(received)
            data_x.append(x)
            x += 1


            plt.plot(data_x, data_y)
            plt.xlabel('Time')
            plt.ylabel('Received Value')
            plt.title('Received Data from ESP32')
            plt.draw()
            plt.pause(0.0001)


loop = asyncio.get_event_loop()
loop.run_until_complete(run(esp32_address))
